!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.SiftTaxi=t()}(this,function(){function e(e,t){return t={exports:{}},e(t,t.exports),t.exports}function t(e){E.trace("[opCreateDb]: ",e);var t={};switch(e.type){case"MSG":t.msg=U("rs_msg_db-"+e.accountGuid,l(F));break;case"SIFT":if(!e.siftGuid)throw new Error("[opCreateDb]: dbInfo.siftGuid undefined");E.trace("[opCreateDb]: creating SIFT db");var n=d(e.schema,!0);n=n.addStore("_user.default").addStore("_redsift"),t.db=U(e.siftGuid+"-"+e.accountGuid,n),t.msg=U("rs_msg_db-"+e.accountGuid,l(F));break;case"SYNC":E.trace("[opCreateDb]: creating SYNC db"),t.db=U("rs_sync_log-"+e.accountGuid,d(A));break;case"CLIENT":t.db=U("rs_client_db-"+e.clientName,d(V));break;default:throw new Error("[opCreateDb]: unsupported db type: "+e.type)}return t}function n(e,t,n){if(E.trace("[opDel]: ",t,n),!t.bucket)return Promise.reject("[opDel]: params.bucket undefined");if(!t.keys||0===t.keys.length)return E.trace("[opDel]: params.keys undefined"),Promise.resolve();if(L.indexOf(t.bucket)!==-1){var r=t.keys.map(function(e){return n+"/"+e});return h(e.msg,{bucket:t.bucket,keys:r})}return h(e.db,t)}function r(e,t,n){if(E.trace("[opGet]: ",t),!t.bucket)return Promise.reject("[opGet]: params.bucket undefined");if(!t.keys||0===t.keys.length)return Promise.reject("[opGet]: param.keys undefined");if(L.indexOf(t.bucket)!==-1){var r=t.keys.map(function(e){return n+"/"+e});return m(e.msg,{bucket:t.bucket,keys:r}).then(function(e){return e.map(function(e){return{key:e.key.split("/")[1],value:e.value}})})}return m(e.db,t)}function i(e,t,n){return E.trace("[opGetAll]: ",t,n),t.bucket?L.indexOf(t.bucket)!==-1?y(e.msg,{bucket:t.bucket,index:"sift.guid",range:n},!0).then(function(e){return e.map(function(e){return{key:e.key.split("/")[1],value:e.value}})}):y(e.db,t,!0):Promise.reject("[opGetAll]: params.bucket undefined")}function s(e,t,n){return E.trace("[opGetAllKeys]: ",t,n),t.bucket?L.indexOf(t.bucket)!==-1?y(e.msg,{bucket:t.bucket,index:"sift.guid",range:n},!1).then(function(e){return e.map(function(e){return e.key.split("/")[1]})}):y(e.db,t,!1):Promise.reject("[opGetAllKeys]: params.bucket undefined")}function o(e,t,n){return E.trace("[opGetIndex]: ",t,n),t.bucket?L.indexOf(t.bucket)!==-1?y(e.msg,{bucket:t.bucket,index:"sift.guid",range:n},!0).then(function(e){return e.map(function(e){return{key:e.key.split("/")[1],value:e.value}})}):t.index?y(e.db,t,!0):Promise.reject("[opGetIndex]:params.index undefined"):Promise.reject("[opGetIndex]:params.bucket undefined")}function a(e,t,n){return E.trace("[opGetIndexKeys]: ",t,n),t.bucket?L.indexOf(t.bucket)!==-1?y(e.msg,{bucket:t.bucket,index:"sift.guid",range:n},!1).then(function(e){return e.map(function(e){return{key:e.key.split("/")[1],value:e.value}})}):t.index?y(e.db,t,!1):Promise.reject("[opGetIndexKeys]: params.index undefined"):Promise.reject("[opGetIndexKeys]: params.bucket undefined")}function u(e,t,n){if(E.trace("[opGetWithIndex]: ",t,n),!t.bucket)return Promise.reject("[opGetWithIndex]:params.bucket undefined");if(!t.keys)return Promise.reject("[opGetWithIndex]:params.keys undefined");if(L.indexOf(t.bucket)!==-1){var r=t.keys.map(function(e){return n+"/"+e});return p(e.msg,{bucket:t.bucket,keys:r,index:"sift.guid",range:n}).then(function(e){return e.map(function(e){return{key:e.key.split("/")[1],value:e.value}})})}return t.index?t.range?p(e.db,t):Promise.reject("[opGetWithIndex]:params.range undefined"):Promise.reject("[opGetWithIndex]:params.index undefined")}function c(e,t,n,r){E.trace("[opPut]: ",t,n,r);var i=e.db;if(!t.bucket)return Promise.reject("[opPut]: params.bucket undefined");if(!t.kvs||0===t.kvs.length)return E.warn("[opPut]: params.kvs undefined"),Promise.resolve();var s=t.kvs;if(n||(s=s.map(function(e){return{key:e.key,value:{value:e.value}}})),L.indexOf(t.bucket)!==-1){i=e.msg;var s=s.map(function(e){return{key:r+"/"+e.key,value:e.value}})}return f(i,{bucket:t.bucket,kvs:s},n)}function d(e,t){E.trace("[_getTreoSchema]: ",e,t);var n=U.schema().version(1);return e.forEach(function(e){t&&L.indexOf(e.name)!==-1||(n=e.keypath?n.addStore(e.name,{key:e.keypath}):n.addStore(e.name),e.indexes&&e.indexes.forEach(function(e){n=n.addIndex(e,e,{unique:!1})}))}),n}function l(e,t){E.trace("[_getVersionedTreoSchema]: ",e,t);var n=U.schema();return e.forEach(function(e,r){n=n.version(r+1),e.forEach(function(e){t&&L.indexOf(e.name)!==-1||(e.drop?(E.trace("[_getVersionedTreoSchema]: dropping store: ",e.name),n=n.dropStore(e.name)):n=e.keypath?n.addStore(e.name,{key:e.keypath}):n.addStore(e.name),e.indexes&&e.indexes.forEach(function(t){e.drop?(E.trace("[_getVersionedTreoSchema]: dropping store/index: "+e.name+"/"+t),n=n.dropIndex(t)):n=n.addIndex(t,t,{unique:!1})}))})}),n}function h(e,t){return E.trace("[_batchDelete]: ",t),new Promise(function(n,r){e.transaction("readwrite",[t.bucket],function(e,i){if(e)return r(e);var s=i.objectStore(t.bucket),o=0,a=function(){if(!(o>=t.keys.length)){var e,n=t.keys[o];e=s.delete(n),e.onerror=r,e.onsuccess=a,o+=1}};i.onerror=i.onabort=r,i.oncomplete=function(){n()},a()})})}function f(e,t){return E.trace("[_batchPut]: ",t),new Promise(function(n,r){var i=t.kvs.length;e.transaction("readwrite",[t.bucket],function(e,s){if(e)return r(e);var o=s.objectStore(t.bucket),a=0,u=function(){if(!(a>=i)){E.trace("[_batchPut: put: ",t.kvs[a]);var e;e=o.put(t.kvs[a].value,t.kvs[a].key),e.onerror=r,e.onsuccess=u,a+=1}};s.onerror=s.onabort=r,s.oncomplete=function(){n()},u()})})}function p(e,t){return E.trace("[_getWithIndexRange]: ",t),new Promise(function(n,r){var i=e.store(t.bucket),s=[],o=0,a=function(e){var n=t.keys.indexOf(e.primaryKey);return n!==-1&&(E.trace("[found key: ",e.primaryKey),s[n].value=e.value.value,o++),o===t.keys.length?u():void e.continue()},u=function(e){E.trace("[_getWithIndexRange: result: ",s),e?r(e):n(s)};t.keys.forEach(function(e){s.push({key:e,value:void 0})}),i.cursor({index:t.index,range:t.range,iterator:a},u)})}function m(e,t){return E.trace("[_findIn]: ",t),new Promise(function(n,r){var i=e.store(t.bucket),s=[],o=0,a=function(e){if(E.trace("[_findIn]: iterator: ",e),e.key>c[o]){for(E.trace("[_findIn]: cursor ahead: ",e.key,c[o]);e.key>c[o]&&o<c.length;)o+=1,E.trace("[_findIn]: moving to next key: ",e.key,c[o]);if(o>c.length)return E.trace("[_findIn]: exhausted keys. done."),u()}e.key===c[o]?(E.trace("[_findIn]: found key: ",e.key,e.value),s[t.keys.indexOf(c[o])]={key:e.key,value:e.value.value},o+=1,o<c.length?e.continue(c[o]):u()):(E.trace("[_findIn]: continuing to next key: ",c[o]),e.continue(c[o]))},u=function(e){E.trace("[findIn]: result: ",s),e?r(e):n(s)},c=t.keys.slice();c=c.sort(U.cmp),E.trace("[findIn: sorted keys: ",c),t.keys.forEach(function(e){s.push({key:e,value:void 0})}),i.cursor({iterator:a},u)})}function y(e,t,n){return E.trace("[_getAll]: ",t,n),new Promise(function(r,i){var s=[],o=[],a=e.store(t.bucket),u=function(e){var r={key:e.primaryKey};E.trace("[_getAll]: cursor",e),n&&(r.value=e.value.value),t.index&&(r.index=e.key),s.push(r),o.push(e.primaryKey),e.continue()},c={iterator:u};t.index&&(c.index=t.index),t.range&&(c.range=t.range),a.cursor(c,function(e){e?i(e):t.index||t.range||n?(E.trace("[_getAll]: resolving: ",s),r(s)):(E.trace("[_getAll]: resolving: ",o),r(o))})})}function _(e){console.log("[Redsift::registerSiftController]: registered")}var g=function(){this._observers=[]};g.prototype.subscribe=function(e,t){this._op("_sub",e,t)},g.prototype.unsubscribe=function(e,t){this._op("_unsub",e,t)},g.prototype.unsubscribeAll=function(e){this._observers[e]&&delete this._observers[e]},g.prototype.publish=function(e,t){this._op("_pub",e,t)},g.prototype._op=function(e,t,n){var r=this;Array.isArray(t)?t.forEach(function(t){r[e](t,n)}):this[e](t,n)},g.prototype._sub=function(e,t){this._observers[e]||(this._observers[e]=[]),t&&this._observers[e].indexOf(t)===-1&&this._observers[e].push(t)},g.prototype._unsub=function(e,t){if(this._observers[e]){var n=this._observers[e].indexOf(t);~n&&this._observers[e].splice(n,1)}},g.prototype._pub=function(e,t){var n=this;if(this._observers[e])for(var r=this._observers[e].length-1;r>=0;r--)n._observers[e][r](t)};var v=function(e){function t(t){e.call(this),this._proxy=t}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.goto=function(e){this._postMessage("goto",e)},t.prototype.close=function(){this._postMessage("close")},t.prototype._postMessage=function(e,t){this._proxy.postMessage({method:"notifyClient",params:{topic:e,value:t}})},t}(g),k=function(e){function t(){e.call(this),this._storage=null}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.init=function(e){this._storage=e},t.prototype.get=function(e){return this._storage.get(e)},t.prototype.getIndexKeys=function(e){return this._storage.getIndexKeys(e)},t.prototype.getIndex=function(e){return this._storage.getIndex(e)},t.prototype.getWithIndex=function(e){return this._storage.getWithIndex(e)},t.prototype.getAllKeys=function(e){return this._storage.getAllKeys(e)},t.prototype.getAll=function(e){return this._storage.getAll(e)},t.prototype.getUser=function(e){return this._storage.getUser(e)},t.prototype.putUser=function(e){return this._storage.putUser(e)},t.prototype.delUser=function(e){return this._storage.delUser(e)},t}(g),w="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},b=e(function(e){!function(t,n){"use strict";"function"==typeof define&&define.amd?define(n):"object"==typeof e&&e.exports?e.exports=n():t.log=n()}(w,function(){"use strict";function e(e){return typeof console!==a&&(void 0!==console[e]?t(console,e):void 0!==console.log?t(console,"log"):o)}function t(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function n(e,t,n){return function(){typeof console!==a&&(r.call(this,t,n),this[e].apply(this,arguments))}}function r(e,t){for(var n=this,r=0;r<u.length;r++){var i=u[r];n[i]=r<e?o:n.methodFactory(i,e,t)}}function i(t,r,i){return e(t)||n.apply(this,arguments)}function s(e,t,n){function s(e){var t=(u[e]||"silent").toUpperCase();try{return void(window.localStorage[l]=t)}catch(e){}try{window.document.cookie=encodeURIComponent(l)+"="+t+";"}catch(e){}}function o(){var e;try{e=window.localStorage[l]}catch(e){}if(typeof e===a)try{var t=window.document.cookie,n=t.indexOf(encodeURIComponent(l)+"=");n&&(e=/^([^;]+)/.exec(t.slice(n))[1])}catch(e){}return void 0===d.levels[e]&&(e=void 0),e}var c,d=this,l="loglevel";e&&(l+=":"+e),d.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},d.methodFactory=n||i,d.getLevel=function(){return c},d.setLevel=function(t,n){if("string"==typeof t&&void 0!==d.levels[t.toUpperCase()]&&(t=d.levels[t.toUpperCase()]),!("number"==typeof t&&t>=0&&t<=d.levels.SILENT))throw"log.setLevel() called with invalid level: "+t;if(c=t,n!==!1&&s(t),r.call(d,t,e),typeof console===a&&t<d.levels.SILENT)return"No console available for logging"},d.setDefaultLevel=function(e){o()||d.setLevel(e,!1)},d.enableAll=function(e){d.setLevel(d.levels.TRACE,e)},d.disableAll=function(e){d.setLevel(d.levels.SILENT,e)};var h=o();null==h&&(h=null==t?"WARN":t),d.setLevel(h,!1)}var o=function(){},a="undefined",u=["trace","debug","info","warn","error"],c=new s,d={};c.getLogger=function(e){if("string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=d[e];return t||(t=d[e]=new s(e,c.getLevel(),c.methodFactory)),t};var l=typeof window!==a?window.log:void 0;return c.noConflict=function(){return typeof window!==a&&window.log===c&&(window.log=l),c},c})}),S=b&&"object"==typeof b&&"default"in b?b.default:b,x=e(function(e){"use strict";var t=Object.prototype.toString;e.exports=function(e){var n;return"[object Object]"===t.call(e)&&(n=Object.getPrototypeOf(e),null===n||n===Object.getPrototypeOf({}))}}),D=x&&"object"==typeof x&&"default"in x?x.default:x,M=e(function(e,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=w.IDBKeyRange||w.webkitIDBKeyRange;if(e instanceof t)return e;if("undefined"==typeof e||null===e)return null;if(!(0,s.default)(e))return t.only(e);var n=Object.keys(e).sort();if(1===n.length){var r=n[0],i=e[r];switch(r){case"eq":return t.only(i);case"gt":return t.lowerBound(i,!0);case"lt":return t.upperBound(i,!0);case"gte":return t.lowerBound(i);case"lte":return t.upperBound(i);default:throw new TypeError('"'+r+'" is not valid key')}}else{var o=e[n[0]],a=e[n[1]],u=n.join("-");switch(u){case"gt-lt":return t.bound(o,a,!0,!0);case"gt-lte":return t.bound(o,a,!0,!1);case"gte-lt":return t.bound(o,a,!1,!0);case"gte-lte":return t.bound(o,a,!1,!1);default:throw new TypeError('"'+u+'" are conflicted keys')}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=D,s=n(i);e.exports=t.default}),Y=M&&"object"==typeof M&&"default"in M?M.default:M,O=e(function(e){function t(e,t,n,r){this.store=e,this.name=t,this.field=n,this.opts=r,this.multi=r.multi||r.multiEntry||!1,this.unique=r.unique||!1}var n=Y;e.exports=t,t.prototype.get=function(e,t){function n(e){r.push(e.value),e.continue()}var r=[],i=this.unique,s={range:e,iterator:n};this.cursor(s,function(e){return e?t(e):void(i?t(null,r[0]):t(null,r))})},t.prototype.count=function(e,t){var r=this.store.name,i=this.name;this.store.db.transaction("readonly",[r],function(s,o){if(s)return t(s);var a=o.objectStore(r).index(i),u=a.count(n(e));u.onerror=t,u.onsuccess=function(e){t(null,e.target.result)}})},t.prototype.cursor=function(e,t){e.index=this.name,this.store.cursor(e,t)}}),T=O&&"object"==typeof O&&"default"in O?O.default:O,P=e(function(e){var t=Object.prototype.toString;e.exports=function(e){switch(t.call(e)){case"[object Date]":return"date";case"[object RegExp]":return"regexp";case"[object Arguments]":return"arguments";case"[object Array]":return"array";case"[object Error]":return"error"}return null===e?"null":void 0===e?"undefined":e!==e?"nan":e&&1===e.nodeType?"element":(e=e.valueOf?e.valueOf():Object.prototype.valueOf.apply(e),typeof e)}}),I=P&&"object"==typeof P&&"default"in P?P.default:P,W=e(function(e){function t(e,t){this.db=null,this.name=e,this.indexes={},this.opts=t,this.key=t.key||t.keyPath||void 0,this.increment=t.increment||t.autoIncretement||void 0}var n=I,r=Y;e.exports=t,t.prototype.index=function(e){return this.indexes[e]},t.prototype.put=function(e,t,r){var i=this.name,s=this.key;s&&("object"==n(e)?(r=t,t=e,e=null):t[s]=e),this.db.transaction("readwrite",[i],function(n,o){if(n)return r(n);var a=o.objectStore(i),u=s?a.put(t):a.put(t,e);o.onerror=o.onabort=u.onerror=r,o.oncomplete=function(){r(null,u.result)}})},t.prototype.get=function(e,t){var n=this.name;this.db.transaction("readonly",[n],function(r,i){if(r)return t(r);var s=i.objectStore(n),o=s.get(e);o.onerror=t,o.onsuccess=function(e){t(null,e.target.result)}})},t.prototype.del=function(e,t){var n=this.name;this.db.transaction("readwrite",[n],function(r,i){if(r)return t(r);var s=i.objectStore(n),o=s.delete(e);i.onerror=i.onabort=o.onerror=t,i.oncomplete=function(){t()}})},t.prototype.count=function(e){var t=this.name;this.db.transaction("readonly",[t],function(n,r){if(n)return e(n);var i=r.objectStore(t),s=i.count();s.onerror=e,s.onsuccess=function(t){e(null,t.target.result)}})},t.prototype.clear=function(e){var t=this.name;this.db.transaction("readwrite",[t],function(n,r){if(n)return e(n);var i=r.objectStore(t),s=i.clear();r.onerror=r.onabort=s.onerror=e,r.oncomplete=function(){e()}})},t.prototype.batch=function(e,t){var n=this.name,r=this.key,i=Object.keys(e);this.db.transaction("readwrite",[n],function(s,o){function a(){if(!(c>=i.length)){var n,s=i[c],o=e[s];null===o?n=u.delete(s):r?(o[r]||(o[r]=s),n=u.put(o)):n=u.put(o,s),n.onerror=t,n.onsuccess=a,c+=1}}if(s)return t(s);var u=o.objectStore(n),c=0;o.onerror=o.onabort=t,o.oncomplete=function(){t()},a()})},t.prototype.all=function(e){function t(e){n.push(e.value),e.continue()}var n=[];this.cursor({iterator:t},function(t){t?e(t):e(null,n)})},t.prototype.cursor=function(e,t){var n=this.name;this.db.transaction("readonly",[n],function(i,s){if(i)return t(i);var o=e.index?s.objectStore(n).index(e.index):s.objectStore(n),a=o.openCursor(r(e.range));a.onerror=t,a.onsuccess=function(n){var r=n.target.result;r?e.iterator(r):t()}})}}),j=W&&"object"==typeof W&&"default"in W?W.default:W,C=e(function(e){function t(){return this instanceof t?(this._stores={},this._current={},void(this._versions={})):new t}var n=I,r=j,i=T;e.exports=t,t.prototype.version=function(e){if("number"!=n(e)||e<1||e<this.getVersion())throw new TypeError("not valid version");return this._current={version:e,store:null},this._versions[e]={stores:[],dropStores:[],indexes:[],dropIndexes:[],version:e},this},t.prototype.addStore=function(e,t){if("string"!=n(e))throw new TypeError("`name` is required");if(this._stores[e])throw new TypeError("store is already defined");var i=new r(e,t||{});return this._stores[e]=i,this._versions[this.getVersion()].stores.push(i),this._current.store=i,this},t.prototype.dropStore=function(e){if("string"!=n(e))throw new TypeError("`name` is required");var t=this._stores[e];if(!t)throw new TypeError("store is not defined");return delete this._stores[e],this._versions[this.getVersion()].dropStores.push(t),this},t.prototype.addIndex=function(e,t,r){if("string"!=n(e))throw new TypeError("`name` is required");if("string"!=n(t)&&"array"!=n(t))throw new TypeError("`field` is required");var s=this._current.store;if(s.indexes[e])throw new TypeError("index is already defined");var o=new i(s,e,t,r||{});return s.indexes[e]=o,this._versions[this.getVersion()].indexes.push(o),this},t.prototype.dropIndex=function(e){if("string"!=n(e))throw new TypeError("`name` is required");var t=this._current.store.indexes[e];if(!t)throw new TypeError("index is not defined");return delete this._current.store.indexes[e],this._versions[this.getVersion()].dropIndexes.push(t),this},t.prototype.getStore=function(e){if("string"!=n(e))throw new TypeError("`name` is required");if(!this._stores[e])throw new TypeError("store is not defined");return this._current.store=this._stores[e],this},t.prototype.getVersion=function(){return this._current.version},t.prototype.callback=function(){var e=Object.keys(this._versions).map(function(e){return this._versions[e]},this).sort(function(e,t){return e.version-t.version});return function(t){var n=t.target.result,r=t.target.transaction;e.forEach(function(e){t.oldVersion>=e.version||(e.stores.forEach(function(e){var t={};"undefined"!=typeof e.key&&(t.keyPath=e.key),"undefined"!=typeof e.increment&&(t.autoIncrement=e.increment),n.createObjectStore(e.name,t)}),e.dropStores.forEach(function(e){n.deleteObjectStore(e.name)}),e.indexes.forEach(function(e){var t=r.objectStore(e.store.name);t.createIndex(e.name,e.field,{unique:e.unique,multiEntry:e.multi})}),e.dropIndexes.forEach(function(e){var t=r.objectStore(e.store.name);t.deleteIndex(e.name)}))})}}}),G=C&&"object"==typeof C&&"default"in C?C.default:C,R=e(function(e,t){function n(e,t){if(!(this instanceof n))return new n(e,t);if("string"!=s(e))throw new TypeError("`name` required");if(!(t instanceof o))throw new TypeError("not valid schema");this.name=e,this.status="close",this.origin=null,this.stores=t._stores,this.version=t.getVersion(),this.onupgradeneeded=t.callback(),Object.keys(this.stores).forEach(function(e){this.stores[e].db=this},this)}function r(){return i().cmp.apply(i(),arguments)}function i(){return w._indexedDB||w.indexedDB||w.msIndexedDB||w.mozIndexedDB||w.webkitIndexedDB}var s=I,o=G,a=j,u=T;t=e.exports=n,t.schema=o,t.cmp=r,t.Treo=n,t.Schema=o,t.Store=a,t.Index=u,n.prototype.use=function(e){return e(this,t),this},n.prototype.drop=function(e){var t=this.name;this.close(function(n){if(n)return e(n);var r=i().deleteDatabase(t);r.onerror=e,r.onsuccess=function(){e()}})},n.prototype.close=function(e){return"close"==this.status?e():void this.getInstance(function(t,n){return t?e(t):(n.origin=null,n.status="close",n.close(),void e())})},n.prototype.store=function(e){return this.stores[e]},n.prototype.getInstance=function(e){if("open"==this.status)return e(null,this.origin);if("opening"==this.status)return this.queue.push(e);this.status="opening",this.queue=[e];var t=this,n=i().open(this.name,this.version);n.onupgradeneeded=this.onupgradeneeded,n.onerror=n.onblocked=function(e){t.status="error",t.queue.forEach(function(t){t(e)}),delete t.queue},n.onsuccess=function(e){t.origin=e.target.result,t.status="open",t.origin.onversionchange=function(){t.close(function(){})},t.queue.forEach(function(e){e(null,t.origin)}),delete t.queue}},n.prototype.transaction=function(e,t,n){this.getInstance(function(r,i){r?n(r):n(null,i.transaction(t,e))})}}),U=R&&"object"==typeof R&&"default"in R?R.default:R,E=S.getLogger("RSStorage:operations");E.setLevel("warn");var L=["_email.id","_email.tid"],F=[[{name:"_id.list",indexes:["sift.guid"]},{name:"_tid.list",indexes:["sift.guid"]}],[{name:"_email.id",indexes:["sift.guid"]},{name:"_email.tid",indexes:["sift.guid"]},{name:"_id.list",drop:!0},{name:"_tid.list",drop:!0}]],A=[{name:"events",indexes:["value.sift.guid"]},{name:"admin"}],V=[{name:"tour"},{name:"spm"},{name:"auth"}],H=new WeakMap,N=new WeakMap,z=function(e,n){if(this._logger=S.getLogger("RSStorage"),this._logger.setLevel(n||"warn"),!e.accountGuid)throw new Error("[Storage]: dbInfo.accountGuid undefined");H.set(this,e.siftGuid),N.set(this,t(e))};z.prototype.get=function(e){return this._logger.trace("[Storage::get]: ",e),r(N.get(this),e,H.get(this))},z.prototype.getAll=function(e){return this._logger.trace("[Storage::getAll]: ",e),i(N.get(this),e,H.get(this))},z.prototype.getAllKeys=function(e){return this._logger.trace("[Storage::getAllKeys]: ",e),s(N.get(this),e,H.get(this))},z.prototype.getIndex=function(e){return this._logger.trace("[Storage::getIndex]: ",e),o(N.get(this),e,H.get(this))},z.prototype.getIndexKeys=function(e){return this._logger.trace("[Storage::getIndexKeys]: ",e),a(N.get(this),e,H.get(this))},z.prototype.getWithIndex=function(e){return this._logger.trace("[Storage::getWithIndex]: ",e),u(N.get(this),e,H.get(this))},z.prototype.delUser=function(e){return e.bucket="_user.default",this._logger.trace("[Storage::delUser]: ",e),n(N.get(this),e,H.get(this))},z.prototype.getUser=function(e){return e.bucket="_user.default",this._logger.trace("[Storage::getUser]: ",e),r(N.get(this),e,H.get(this))},z.prototype.putUser=function(e){return e.bucket="_user.default",this._logger.trace("[Storage::putUser]: ",e),e.kvs&&0!==e.kvs.length?c(N.get(this),e,!1,H.get(this)):Promise.reject("[Storage::putUser]: params.kvs undefined")};var q=function(){this._proxy=self,this.view=new g,this.emailclient=new v(self),this._registerMessageListeners()};q.prototype.publish=function(e,t){this._proxy.postMessage({method:"notifyView",params:{topic:e,value:t}})},q.prototype._registerMessageListeners=function(){var e=this;this._proxy&&(this._proxy.onmessage=function(t){var n=t.data.method;e["_"+n]&&e["_"+n](t.data.params)})},q.prototype._init=function(e){this.storage=new k,this.storage.init(new z({type:"SIFT",siftGuid:e.siftGuid,accountGuid:e.accountGuid,schema:e.dbSchema})),this._guid=e.siftGuid,this._account=e.accountGuid,this._proxy.postMessage({method:"initCallback",result:e})},q.prototype._terminate=function(){this._proxy&&this._proxy.close()},q.prototype._postCallback=function(e,t){this._proxy.postMessage({method:"loadViewCallback",params:{user:{guid:this._account},sift:{guid:this._guid},type:e.type,sizeClass:e.sizeClass,result:t}})},q.prototype._loadView=function(e){var t=this;if(!this.loadView)return void console.error("[SiftController::_loadView]: Sift controller must implement the loadView method");var n=this.loadView({sizeClass:e.sizeClass,type:e.type,params:e.data});n.data&&"function"==typeof n.data.then?(n.html&&this._postCallback(e,{html:n.html}),n.data.then(function(r){t._postCallback(e,{html:n.html,data:r})}).catch(function(e){console.error("[SiftController::loadView]: promise rejected: ",e)})):this._postCallback(e,n)},q.prototype._storageUpdated=function(e){var t=this;this.storage.publish("*",e),e.forEach(function(e){t.storage.publish(e,[e])})},q.prototype._notifyController=function(e){this.view.publish(e.topic,e.value)},q.prototype._emailComposer=function(e){this.emailclient.publish(e.topic,e.value)};var Z=e(function(e,t){!function(n,r){"object"==typeof t&&"undefined"!=typeof e?e.exports=r():"function"==typeof define&&define.amd?define(r):n.moment=r()}(w,function(){"use strict";function t(){return pr.apply(null,arguments)}function n(e){pr=e}function r(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function i(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function s(e){var t;for(t in e)return!1;return!0}function o(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function a(e,t){var n,r=[];for(n=0;n<e.length;++n)r.push(t(e[n],n));return r}function u(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function c(e,t){for(var n in t)u(t,n)&&(e[n]=t[n]);return u(t,"toString")&&(e.toString=t.toString),u(t,"valueOf")&&(e.valueOf=t.valueOf),e}function d(e,t,n,r){return _t(e,t,n,r,!0).utc()}function l(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null}}function h(e){return null==e._pf&&(e._pf=l()),e._pf}function f(e){if(null==e._isValid){var t=h(e),n=mr.call(t.parsedDateParts,function(e){return null!=e}),r=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&n);if(e._strict&&(r=r&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return r;e._isValid=r}return e._isValid}function p(e){var t=d(NaN);return null!=e?c(h(t),e):h(t).userInvalidated=!0,t}function m(e){return void 0===e}function y(e,t){var n,r,i;if(m(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),m(t._i)||(e._i=t._i),m(t._f)||(e._f=t._f),m(t._l)||(e._l=t._l),m(t._strict)||(e._strict=t._strict),m(t._tzm)||(e._tzm=t._tzm),m(t._isUTC)||(e._isUTC=t._isUTC),m(t._offset)||(e._offset=t._offset),m(t._pf)||(e._pf=h(t)),m(t._locale)||(e._locale=t._locale),yr.length>0)for(n in yr)r=yr[n],i=t[r],m(i)||(e[r]=i);return e}function _(e){y(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),_r===!1&&(_r=!0,t.updateOffset(this),_r=!1)}function g(e){return e instanceof _||null!=e&&null!=e._isAMomentObject}function v(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function k(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=v(t)),n}function w(e,t,n){var r,i=Math.min(e.length,t.length),s=Math.abs(e.length-t.length),o=0;for(r=0;r<i;r++)(n&&e[r]!==t[r]||!n&&k(e[r])!==k(t[r]))&&o++;return o+s}function b(e){t.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function S(e,n){var r=!0;return c(function(){var i=arguments;if(null!=t.deprecationHandler&&t.deprecationHandler(null,e),r){for(var s,o=[],a=0;a<arguments.length;a++){if(s="","object"==typeof i[a]){s+="\n["+a+"] ";for(var u in arguments[0])s+=u+": "+i[0][u]+", ";s=s.slice(0,-2)}else s=i[a];o.push(s)}b(e+"\nArguments: "+Array.prototype.slice.call(o).join("")+"\n"+(new Error).stack),r=!1}return n.apply(this,arguments)},n)}function x(e,n){null!=t.deprecationHandler&&t.deprecationHandler(e,n),gr[e]||(b(n),gr[e]=!0)}function D(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function M(e){var t,n,r=this;for(n in e)t=e[n],D(t)?r[n]=t:r["_"+n]=t;this._config=e,this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}function Y(e,t){var n,r=c({},e);for(n in t)u(t,n)&&(i(e[n])&&i(t[n])?(r[n]={},c(r[n],e[n]),c(r[n],t[n])):null!=t[n]?r[n]=t[n]:delete r[n]);for(n in e)u(e,n)&&!u(t,n)&&i(e[n])&&(r[n]=c({},r[n]));return r}function O(e){null!=e&&this.set(e)}function T(e,t,n){var r=this._calendar[e]||this._calendar.sameElse;return D(r)?r.call(t,n):r}function P(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])}function I(){return this._invalidDate}function W(e){return this._ordinal.replace("%d",e)}function j(e,t,n,r){var i=this._relativeTime[n];return D(i)?i(e,t,n,r):i.replace(/%d/i,e)}function C(e,t){var n=this._relativeTime[e>0?"future":"past"];return D(n)?n(t):n.replace(/%s/i,t)}function G(e,t){var n=e.toLowerCase();Yr[n]=Yr[n+"s"]=Yr[t]=e}function R(e){return"string"==typeof e?Yr[e]||Yr[e.toLowerCase()]:void 0}function U(e){var t,n,r={};for(n in e)u(e,n)&&(t=R(n),t&&(r[t]=e[n]));return r}function E(e,t){Or[e]=t}function L(e){var t=[];for(var n in e)t.push({unit:n,priority:Or[n]});return t.sort(function(e,t){return e.priority-t.priority}),t}function F(e,n){return function(r){return null!=r?(V(this,e,r),t.updateOffset(this,n),this):A(this,e)}}function A(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function V(e,t,n){e.isValid()&&e._d["set"+(e._isUTC?"UTC":"")+t](n)}function H(e){return e=R(e),D(this[e])?this[e]():this}function N(e,t){var n=this;if("object"==typeof e){e=U(e);for(var r=L(e),i=0;i<r.length;i++)n[r[i].unit](e[r[i].unit])}else if(e=R(e),D(this[e]))return this[e](t);return this}function z(e,t,n){var r=""+Math.abs(e),i=t-r.length,s=e>=0;return(s?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}function q(e,t,n,r){var i=r;"string"==typeof r&&(i=function(){return this[r]()}),e&&(Wr[e]=i),t&&(Wr[t[0]]=function(){return z(i.apply(this,arguments),t[1],t[2])}),n&&(Wr[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function Z(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function K(e){var t,n,r=e.match(Tr);for(t=0,n=r.length;t<n;t++)Wr[r[t]]?r[t]=Wr[r[t]]:r[t]=Z(r[t]);return function(t){var i,s="";for(i=0;i<n;i++)s+=r[i]instanceof Function?r[i].call(t,e):r[i];return s}}function B(e,t){return e.isValid()?(t=J(t,e.localeData()),Ir[t]=Ir[t]||K(t),Ir[t](e)):e.localeData().invalidDate()}function J(e,t){function n(e){return t.longDateFormat(e)||e}var r=5;for(Pr.lastIndex=0;r>=0&&Pr.test(e);)e=e.replace(Pr,n),Pr.lastIndex=0,r-=1;return e}function $(e,t,n){Jr[e]=D(t)?t:function(e,r){return e&&n?n:t}}function Q(e,t){return u(Jr,e)?Jr[e](t._strict,t._locale):new RegExp(X(e))}function X(e){return ee(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,r,i){return t||n||r||i}))}function ee(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function te(e,t){var n,r=t;for("string"==typeof e&&(e=[e]),"number"==typeof t&&(r=function(e,n){n[t]=k(e)}),n=0;n<e.length;n++)$r[e[n]]=r}function ne(e,t){te(e,function(e,n,r,i){r._w=r._w||{},t(e,r._w,r,i)})}function re(e,t,n){null!=t&&u($r,e)&&$r[e](t,n._a,n,e)}function ie(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function se(e,t){return e?r(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||ai).test(t)?"format":"standalone"][e.month()]:this._months}function oe(e,t){return e?r(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[ai.test(t)?"format":"standalone"][e.month()]:this._monthsShort}function ae(e,t,n){var r,i,s,o=this,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)s=d([2e3,r]),o._shortMonthsParse[r]=o.monthsShort(s,"").toLocaleLowerCase(),o._longMonthsParse[r]=o.months(s,"").toLocaleLowerCase();return n?"MMM"===t?(i=kr.call(this._shortMonthsParse,a),i!==-1?i:null):(i=kr.call(this._longMonthsParse,a),i!==-1?i:null):"MMM"===t?(i=kr.call(this._shortMonthsParse,a),
i!==-1?i:(i=kr.call(this._longMonthsParse,a),i!==-1?i:null)):(i=kr.call(this._longMonthsParse,a),i!==-1?i:(i=kr.call(this._shortMonthsParse,a),i!==-1?i:null))}function ue(e,t,n){var r,i,s,o=this;if(this._monthsParseExact)return ae.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=d([2e3,r]),n&&!o._longMonthsParse[r]&&(o._longMonthsParse[r]=new RegExp("^"+o.months(i,"").replace(".","")+"$","i"),o._shortMonthsParse[r]=new RegExp("^"+o.monthsShort(i,"").replace(".","")+"$","i")),n||o._monthsParse[r]||(s="^"+o.months(i,"")+"|^"+o.monthsShort(i,""),o._monthsParse[r]=new RegExp(s.replace(".",""),"i")),n&&"MMMM"===t&&o._longMonthsParse[r].test(e))return r;if(n&&"MMM"===t&&o._shortMonthsParse[r].test(e))return r;if(!n&&o._monthsParse[r].test(e))return r}}function ce(e,t){var n;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=k(t);else if(t=e.localeData().monthsParse(t),"number"!=typeof t)return e;return n=Math.min(e.date(),ie(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function de(e){return null!=e?(ce(this,e),t.updateOffset(this,!0),this):A(this,"Month")}function le(){return ie(this.year(),this.month())}function he(e){return this._monthsParseExact?(u(this,"_monthsRegex")||pe.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(u(this,"_monthsShortRegex")||(this._monthsShortRegex=di),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function fe(e){return this._monthsParseExact?(u(this,"_monthsRegex")||pe.call(this),e?this._monthsStrictRegex:this._monthsRegex):(u(this,"_monthsRegex")||(this._monthsRegex=li),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function pe(){function e(e,t){return t.length-e.length}var t,n,r=this,i=[],s=[],o=[];for(t=0;t<12;t++)n=d([2e3,t]),i.push(r.monthsShort(n,"")),s.push(r.months(n,"")),o.push(r.months(n,"")),o.push(r.monthsShort(n,""));for(i.sort(e),s.sort(e),o.sort(e),t=0;t<12;t++)i[t]=ee(i[t]),s[t]=ee(s[t]);for(t=0;t<24;t++)o[t]=ee(o[t]);this._monthsRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+i.join("|")+")","i")}function me(e){return ye(e)?366:365}function ye(e){return e%4===0&&e%100!==0||e%400===0}function _e(){return ye(this.year())}function ge(e,t,n,r,i,s,o){var a=new Date(e,t,n,r,i,s,o);return e<100&&e>=0&&isFinite(a.getFullYear())&&a.setFullYear(e),a}function ve(e){var t=new Date(Date.UTC.apply(null,arguments));return e<100&&e>=0&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e),t}function ke(e,t,n){var r=7+t-n,i=(7+ve(e,0,r).getUTCDay()-t)%7;return-i+r-1}function we(e,t,n,r,i){var s,o,a=(7+n-r)%7,u=ke(e,r,i),c=1+7*(t-1)+a+u;return c<=0?(s=e-1,o=me(s)+c):c>me(e)?(s=e+1,o=c-me(e)):(s=e,o=c),{year:s,dayOfYear:o}}function be(e,t,n){var r,i,s=ke(e.year(),t,n),o=Math.floor((e.dayOfYear()-s-1)/7)+1;return o<1?(i=e.year()-1,r=o+Se(i,t,n)):o>Se(e.year(),t,n)?(r=o-Se(e.year(),t,n),i=e.year()+1):(i=e.year(),r=o),{week:r,year:i}}function Se(e,t,n){var r=ke(e,t,n),i=ke(e+1,t,n);return(me(e)-r+i)/7}function xe(e){return be(e,this._week.dow,this._week.doy).week}function De(){return this._week.dow}function Me(){return this._week.doy}function Ye(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function Oe(e){var t=be(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function Te(e,t){return"string"!=typeof e?e:isNaN(e)?(e=t.weekdaysParse(e),"number"==typeof e?e:null):parseInt(e,10)}function Pe(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function Ie(e,t){return e?r(this._weekdays)?this._weekdays[e.day()]:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"][e.day()]:this._weekdays}function We(e){return e?this._weekdaysShort[e.day()]:this._weekdaysShort}function je(e){return e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Ce(e,t,n){var r,i,s,o=this,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)s=d([2e3,1]).day(r),o._minWeekdaysParse[r]=o.weekdaysMin(s,"").toLocaleLowerCase(),o._shortWeekdaysParse[r]=o.weekdaysShort(s,"").toLocaleLowerCase(),o._weekdaysParse[r]=o.weekdays(s,"").toLocaleLowerCase();return n?"dddd"===t?(i=kr.call(this._weekdaysParse,a),i!==-1?i:null):"ddd"===t?(i=kr.call(this._shortWeekdaysParse,a),i!==-1?i:null):(i=kr.call(this._minWeekdaysParse,a),i!==-1?i:null):"dddd"===t?(i=kr.call(this._weekdaysParse,a),i!==-1?i:(i=kr.call(this._shortWeekdaysParse,a),i!==-1?i:(i=kr.call(this._minWeekdaysParse,a),i!==-1?i:null))):"ddd"===t?(i=kr.call(this._shortWeekdaysParse,a),i!==-1?i:(i=kr.call(this._weekdaysParse,a),i!==-1?i:(i=kr.call(this._minWeekdaysParse,a),i!==-1?i:null))):(i=kr.call(this._minWeekdaysParse,a),i!==-1?i:(i=kr.call(this._weekdaysParse,a),i!==-1?i:(i=kr.call(this._shortWeekdaysParse,a),i!==-1?i:null)))}function Ge(e,t,n){var r,i,s,o=this;if(this._weekdaysParseExact)return Ce.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=d([2e3,1]).day(r),n&&!o._fullWeekdaysParse[r]&&(o._fullWeekdaysParse[r]=new RegExp("^"+o.weekdays(i,"").replace(".",".?")+"$","i"),o._shortWeekdaysParse[r]=new RegExp("^"+o.weekdaysShort(i,"").replace(".",".?")+"$","i"),o._minWeekdaysParse[r]=new RegExp("^"+o.weekdaysMin(i,"").replace(".",".?")+"$","i")),o._weekdaysParse[r]||(s="^"+o.weekdays(i,"")+"|^"+o.weekdaysShort(i,"")+"|^"+o.weekdaysMin(i,""),o._weekdaysParse[r]=new RegExp(s.replace(".",""),"i")),n&&"dddd"===t&&o._fullWeekdaysParse[r].test(e))return r;if(n&&"ddd"===t&&o._shortWeekdaysParse[r].test(e))return r;if(n&&"dd"===t&&o._minWeekdaysParse[r].test(e))return r;if(!n&&o._weekdaysParse[r].test(e))return r}}function Re(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=Te(e,this.localeData()),this.add(e-t,"d")):t}function Ue(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function Ee(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=Pe(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7}function Le(e){return this._weekdaysParseExact?(u(this,"_weekdaysRegex")||Ve.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(u(this,"_weekdaysRegex")||(this._weekdaysRegex=_i),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function Fe(e){return this._weekdaysParseExact?(u(this,"_weekdaysRegex")||Ve.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(u(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=gi),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Ae(e){return this._weekdaysParseExact?(u(this,"_weekdaysRegex")||Ve.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(u(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=vi),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Ve(){function e(e,t){return t.length-e.length}var t,n,r,i,s,o=this,a=[],u=[],c=[],l=[];for(t=0;t<7;t++)n=d([2e3,1]).day(t),r=o.weekdaysMin(n,""),i=o.weekdaysShort(n,""),s=o.weekdays(n,""),a.push(r),u.push(i),c.push(s),l.push(r),l.push(i),l.push(s);for(a.sort(e),u.sort(e),c.sort(e),l.sort(e),t=0;t<7;t++)u[t]=ee(u[t]),c[t]=ee(c[t]),l[t]=ee(l[t]);this._weekdaysRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function He(){return this.hours()%12||12}function Ne(){return this.hours()||24}function ze(e,t){q(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function qe(e,t){return t._meridiemParse}function Ze(e){return"p"===(e+"").toLowerCase().charAt(0)}function Ke(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"}function Be(e){return e?e.toLowerCase().replace("_","-"):e}function Je(e){for(var t,n,r,i,s=0;s<e.length;){for(i=Be(e[s]).split("-"),t=i.length,n=Be(e[s+1]),n=n?n.split("-"):null;t>0;){if(r=$e(i.slice(0,t).join("-")))return r;if(n&&n.length>=t&&w(i,n,!0)>=t-1)break;t--}s++}return null}function $e(t){var n=null;if(!xi[t]&&"undefined"!=typeof e&&e&&e.exports)try{n=ki._abbr,require("./locale/"+t),Qe(n)}catch(e){}return xi[t]}function Qe(e,t){var n;return e&&(n=m(t)?tt(e):Xe(e,t),n&&(ki=n)),ki._abbr}function Xe(e,t){if(null!==t){var n=Si;return t.abbr=e,null!=xi[e]?(x("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=xi[e]._config):null!=t.parentLocale&&(null!=xi[t.parentLocale]?n=xi[t.parentLocale]._config:x("parentLocaleUndefined","specified parentLocale is not defined yet. See http://momentjs.com/guides/#/warnings/parent-locale/")),xi[e]=new O(Y(n,t)),Qe(e),xi[e]}return delete xi[e],null}function et(e,t){if(null!=t){var n,r=Si;null!=xi[e]&&(r=xi[e]._config),t=Y(r,t),n=new O(t),n.parentLocale=xi[e],xi[e]=n,Qe(e)}else null!=xi[e]&&(null!=xi[e].parentLocale?xi[e]=xi[e].parentLocale:null!=xi[e]&&delete xi[e]);return xi[e]}function tt(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return ki;if(!r(e)){if(t=$e(e))return t;e=[e]}return Je(e)}function nt(){return vr(xi)}function rt(e){var t,n=e._a;return n&&h(e).overflow===-2&&(t=n[Xr]<0||n[Xr]>11?Xr:n[ei]<1||n[ei]>ie(n[Qr],n[Xr])?ei:n[ti]<0||n[ti]>24||24===n[ti]&&(0!==n[ni]||0!==n[ri]||0!==n[ii])?ti:n[ni]<0||n[ni]>59?ni:n[ri]<0||n[ri]>59?ri:n[ii]<0||n[ii]>999?ii:-1,h(e)._overflowDayOfYear&&(t<Qr||t>ei)&&(t=ei),h(e)._overflowWeeks&&t===-1&&(t=si),h(e)._overflowWeekday&&t===-1&&(t=oi),h(e).overflow=t),e}function it(e){var t,n,r,i,s,o,a=e._i,u=Di.exec(a)||Mi.exec(a);if(u){for(h(e).iso=!0,t=0,n=Oi.length;t<n;t++)if(Oi[t][1].exec(u[1])){i=Oi[t][0],r=Oi[t][2]!==!1;break}if(null==i)return void(e._isValid=!1);if(u[3]){for(t=0,n=Ti.length;t<n;t++)if(Ti[t][1].exec(u[3])){s=(u[2]||" ")+Ti[t][0];break}if(null==s)return void(e._isValid=!1)}if(!r&&null!=s)return void(e._isValid=!1);if(u[4]){if(!Yi.exec(u[4]))return void(e._isValid=!1);o="Z"}e._f=i+(s||"")+(o||""),dt(e)}else e._isValid=!1}function st(e){var n=Pi.exec(e._i);return null!==n?void(e._d=new Date((+n[1]))):(it(e),void(e._isValid===!1&&(delete e._isValid,t.createFromInputFallback(e))))}function ot(e,t,n){return null!=e?e:null!=t?t:n}function at(e){var n=new Date(t.now());return e._useUTC?[n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()]:[n.getFullYear(),n.getMonth(),n.getDate()]}function ut(e){var t,n,r,i,s=[];if(!e._d){for(r=at(e),e._w&&null==e._a[ei]&&null==e._a[Xr]&&ct(e),e._dayOfYear&&(i=ot(e._a[Qr],r[Qr]),e._dayOfYear>me(i)&&(h(e)._overflowDayOfYear=!0),n=ve(i,0,e._dayOfYear),e._a[Xr]=n.getUTCMonth(),e._a[ei]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=s[t]=r[t];for(;t<7;t++)e._a[t]=s[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[ti]&&0===e._a[ni]&&0===e._a[ri]&&0===e._a[ii]&&(e._nextDay=!0,e._a[ti]=0),e._d=(e._useUTC?ve:ge).apply(null,s),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[ti]=24)}}function ct(e){var t,n,r,i,s,o,a,u;t=e._w,null!=t.GG||null!=t.W||null!=t.E?(s=1,o=4,n=ot(t.GG,e._a[Qr],be(gt(),1,4).year),r=ot(t.W,1),i=ot(t.E,1),(i<1||i>7)&&(u=!0)):(s=e._locale._week.dow,o=e._locale._week.doy,n=ot(t.gg,e._a[Qr],be(gt(),s,o).year),r=ot(t.w,1),null!=t.d?(i=t.d,(i<0||i>6)&&(u=!0)):null!=t.e?(i=t.e+s,(t.e<0||t.e>6)&&(u=!0)):i=s),r<1||r>Se(n,s,o)?h(e)._overflowWeeks=!0:null!=u?h(e)._overflowWeekday=!0:(a=we(n,r,i,s,o),e._a[Qr]=a.year,e._dayOfYear=a.dayOfYear)}function dt(e){if(e._f===t.ISO_8601)return void it(e);e._a=[],h(e).empty=!0;var n,r,i,s,o,a=""+e._i,u=a.length,c=0;for(i=J(e._f,e._locale).match(Tr)||[],n=0;n<i.length;n++)s=i[n],r=(a.match(Q(s,e))||[])[0],r&&(o=a.substr(0,a.indexOf(r)),o.length>0&&h(e).unusedInput.push(o),a=a.slice(a.indexOf(r)+r.length),c+=r.length),Wr[s]?(r?h(e).empty=!1:h(e).unusedTokens.push(s),re(s,r,e)):e._strict&&!r&&h(e).unusedTokens.push(s);h(e).charsLeftOver=u-c,a.length>0&&h(e).unusedInput.push(a),e._a[ti]<=12&&h(e).bigHour===!0&&e._a[ti]>0&&(h(e).bigHour=void 0),h(e).parsedDateParts=e._a.slice(0),h(e).meridiem=e._meridiem,e._a[ti]=lt(e._locale,e._a[ti],e._meridiem),ut(e),rt(e)}function lt(e,t,n){var r;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?(r=e.isPM(n),r&&t<12&&(t+=12),r||12!==t||(t=0),t):t}function ht(e){var t,n,r,i,s;if(0===e._f.length)return h(e).invalidFormat=!0,void(e._d=new Date(NaN));for(i=0;i<e._f.length;i++)s=0,t=y({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[i],dt(t),f(t)&&(s+=h(t).charsLeftOver,s+=10*h(t).unusedTokens.length,h(t).score=s,(null==r||s<r)&&(r=s,n=t));c(e,n||t)}function ft(e){if(!e._d){var t=U(e._i);e._a=a([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),ut(e)}}function pt(e){var t=new _(rt(mt(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function mt(e){var t=e._i,n=e._f;return e._locale=e._locale||tt(e._l),null===t||void 0===n&&""===t?p({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),g(t)?new _(rt(t)):(r(n)?ht(e):o(t)?e._d=t:n?dt(e):yt(e),f(e)||(e._d=null),e))}function yt(e){var n=e._i;void 0===n?e._d=new Date(t.now()):o(n)?e._d=new Date(n.valueOf()):"string"==typeof n?st(e):r(n)?(e._a=a(n.slice(0),function(e){return parseInt(e,10)}),ut(e)):"object"==typeof n?ft(e):"number"==typeof n?e._d=new Date(n):t.createFromInputFallback(e)}function _t(e,t,n,o,a){var u={};return"boolean"==typeof n&&(o=n,n=void 0),(i(e)&&s(e)||r(e)&&0===e.length)&&(e=void 0),u._isAMomentObject=!0,u._useUTC=u._isUTC=a,u._l=n,u._i=e,u._f=t,u._strict=o,pt(u)}function gt(e,t,n,r){return _t(e,t,n,r,!1)}function vt(e,t){var n,i;if(1===t.length&&r(t[0])&&(t=t[0]),!t.length)return gt();for(n=t[0],i=1;i<t.length;++i)t[i].isValid()&&!t[i][e](n)||(n=t[i]);return n}function kt(){var e=[].slice.call(arguments,0);return vt("isBefore",e)}function wt(){var e=[].slice.call(arguments,0);return vt("isAfter",e)}function bt(e){var t=U(e),n=t.year||0,r=t.quarter||0,i=t.month||0,s=t.week||0,o=t.day||0,a=t.hour||0,u=t.minute||0,c=t.second||0,d=t.millisecond||0;this._milliseconds=+d+1e3*c+6e4*u+1e3*a*60*60,this._days=+o+7*s,this._months=+i+3*r+12*n,this._data={},this._locale=tt(),this._bubble()}function St(e){return e instanceof bt}function xt(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function Dt(e,t){q(e,0,0,function(){var e=this.utcOffset(),n="+";return e<0&&(e=-e,n="-"),n+z(~~(e/60),2)+t+z(~~e%60,2)})}function Mt(e,t){var n=(t||"").match(e)||[],r=n[n.length-1]||[],i=(r+"").match(Ci)||["-",0,0],s=+(60*i[1])+k(i[2]);return"+"===i[0]?s:-s}function Yt(e,n){var r,i;return n._isUTC?(r=n.clone(),i=(g(e)||o(e)?e.valueOf():gt(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+i),t.updateOffset(r,!1),r):gt(e).local()}function Ot(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function Tt(e,n){var r,i=this._offset||0;return this.isValid()?null!=e?("string"==typeof e?e=Mt(Zr,e):Math.abs(e)<16&&(e=60*e),!this._isUTC&&n&&(r=Ot(this)),this._offset=e,this._isUTC=!0,null!=r&&this.add(r,"m"),i!==e&&(!n||this._changeInProgress?zt(this,Ft(e-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,t.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?i:Ot(this):null!=e?this:NaN}function Pt(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function It(e){return this.utcOffset(0,e)}function Wt(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Ot(this),"m")),this}function jt(){if(this._tzm)this.utcOffset(this._tzm);else if("string"==typeof this._i){var e=Mt(qr,this._i);0===e?this.utcOffset(0,!0):this.utcOffset(Mt(qr,this._i))}return this}function Ct(e){return!!this.isValid()&&(e=e?gt(e).utcOffset():0,(this.utcOffset()-e)%60===0)}function Gt(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Rt(){if(!m(this._isDSTShifted))return this._isDSTShifted;var e={};if(y(e,this),e=mt(e),e._a){var t=e._isUTC?d(e._a):gt(e._a);this._isDSTShifted=this.isValid()&&w(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function Ut(){return!!this.isValid()&&!this._isUTC}function Et(){return!!this.isValid()&&this._isUTC}function Lt(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}function Ft(e,t){var n,r,i,s=e,o=null;return St(e)?s={ms:e._milliseconds,d:e._days,M:e._months}:"number"==typeof e?(s={},t?s[t]=e:s.milliseconds=e):(o=Gi.exec(e))?(n="-"===o[1]?-1:1,s={y:0,d:k(o[ei])*n,h:k(o[ti])*n,m:k(o[ni])*n,s:k(o[ri])*n,ms:k(xt(1e3*o[ii]))*n}):(o=Ri.exec(e))?(n="-"===o[1]?-1:1,s={y:At(o[2],n),M:At(o[3],n),w:At(o[4],n),d:At(o[5],n),h:At(o[6],n),m:At(o[7],n),s:At(o[8],n)}):null==s?s={}:"object"==typeof s&&("from"in s||"to"in s)&&(i=Ht(gt(s.from),gt(s.to)),s={},s.ms=i.milliseconds,s.M=i.months),r=new bt(s),St(e)&&u(e,"_locale")&&(r._locale=e._locale),r}function At(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function Vt(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function Ht(e,t){var n;return e.isValid()&&t.isValid()?(t=Yt(t,e),e.isBefore(t)?n=Vt(e,t):(n=Vt(t,e),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function Nt(e,t){return function(n,r){var i,s;return null===r||isNaN(+r)||(x(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=n,n=r,r=s),n="string"==typeof n?+n:n,i=Ft(n,r),zt(this,i,e),this}}function zt(e,n,r,i){var s=n._milliseconds,o=xt(n._days),a=xt(n._months);e.isValid()&&(i=null==i||i,s&&e._d.setTime(e._d.valueOf()+s*r),o&&V(e,"Date",A(e,"Date")+o*r),a&&ce(e,A(e,"Month")+a*r),i&&t.updateOffset(e,o||a))}function qt(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function Zt(e,n){var r=e||gt(),i=Yt(r,this).startOf("day"),s=t.calendarFormat(this,i)||"sameElse",o=n&&(D(n[s])?n[s].call(this,r):n[s]);return this.format(o||this.localeData().calendar(s,this,gt(r)))}function Kt(){return new _(this)}function Bt(e,t){var n=g(e)?e:gt(e);return!(!this.isValid()||!n.isValid())&&(t=R(m(t)?"millisecond":t),"millisecond"===t?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())}function Jt(e,t){var n=g(e)?e:gt(e);return!(!this.isValid()||!n.isValid())&&(t=R(m(t)?"millisecond":t),"millisecond"===t?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())}function $t(e,t,n,r){return r=r||"()",("("===r[0]?this.isAfter(e,n):!this.isBefore(e,n))&&(")"===r[1]?this.isBefore(t,n):!this.isAfter(t,n))}function Qt(e,t){var n,r=g(e)?e:gt(e);return!(!this.isValid()||!r.isValid())&&(t=R(t||"millisecond"),"millisecond"===t?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))}function Xt(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function en(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function tn(e,t,n){var r,i,s,o;return this.isValid()?(r=Yt(e,this),r.isValid()?(i=6e4*(r.utcOffset()-this.utcOffset()),t=R(t),"year"===t||"month"===t||"quarter"===t?(o=nn(this,r),"quarter"===t?o/=3:"year"===t&&(o/=12)):(s=this-r,o="second"===t?s/1e3:"minute"===t?s/6e4:"hour"===t?s/36e5:"day"===t?(s-i)/864e5:"week"===t?(s-i)/6048e5:s),n?o:v(o)):NaN):NaN}function nn(e,t){var n,r,i=12*(t.year()-e.year())+(t.month()-e.month()),s=e.clone().add(i,"months");return t-s<0?(n=e.clone().add(i-1,"months"),r=(t-s)/(s-n)):(n=e.clone().add(i+1,"months"),r=(t-s)/(n-s)),-(i+r)||0}function rn(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function sn(){var e=this.clone().utc();return 0<e.year()&&e.year()<=9999?D(Date.prototype.toISOString)?this.toDate().toISOString():B(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):B(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function on(e){e||(e=this.isUtc()?t.defaultFormatUtc:t.defaultFormat);var n=B(this,e);return this.localeData().postformat(n)}function an(e,t){return this.isValid()&&(g(e)&&e.isValid()||gt(e).isValid())?Ft({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function un(e){return this.from(gt(),e)}function cn(e,t){return this.isValid()&&(g(e)&&e.isValid()||gt(e).isValid())?Ft({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function dn(e){return this.to(gt(),e)}function ln(e){var t;return void 0===e?this._locale._abbr:(t=tt(e),null!=t&&(this._locale=t),this)}function hn(){return this._locale}function fn(e){switch(e=R(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this}function pn(e){return e=R(e),void 0===e||"millisecond"===e?this:("date"===e&&(e="day"),this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms"))}function mn(){return this._d.valueOf()-6e4*(this._offset||0)}function yn(){return Math.floor(this.valueOf()/1e3)}function _n(){return new Date(this.valueOf())}function gn(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function vn(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function kn(){return this.isValid()?this.toISOString():null}function wn(){return f(this)}function bn(){return c({},h(this))}function Sn(){return h(this).overflow}function xn(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function Dn(e,t){q(0,[e,e.length],0,t)}function Mn(e){return Pn.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Yn(e){return Pn.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function On(){return Se(this.year(),1,4)}function Tn(){var e=this.localeData()._week;return Se(this.year(),e.dow,e.doy)}function Pn(e,t,n,r,i){var s;return null==e?be(this,r,i).year:(s=Se(e,r,i),t>s&&(t=s),In.call(this,e,t,n,r,i))}function In(e,t,n,r,i){var s=we(e,t,n,r,i),o=ve(s.year,0,s.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}function Wn(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}function jn(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}function Cn(e,t){t[ii]=k(1e3*("0."+e))}function Gn(){return this._isUTC?"UTC":""}function Rn(){return this._isUTC?"Coordinated Universal Time":""}function Un(e){return gt(1e3*e)}function En(){return gt.apply(null,arguments).parseZone()}function Ln(e){return e}function Fn(e,t,n,r){var i=tt(),s=d().set(r,t);return i[n](s,e)}function An(e,t,n){if("number"==typeof e&&(t=e,e=void 0),e=e||"",null!=t)return Fn(e,t,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=Fn(e,r,n,"month");return i}function Vn(e,t,n,r){"boolean"==typeof e?("number"==typeof t&&(n=t,t=void 0),t=t||""):(t=e,n=t,e=!1,"number"==typeof t&&(n=t,t=void 0),t=t||"");var i=tt(),s=e?i._week.dow:0;if(null!=n)return Fn(t,(n+s)%7,r,"day");var o,a=[];for(o=0;o<7;o++)a[o]=Fn(t,(o+s)%7,r,"day");return a}function Hn(e,t){return An(e,t,"months")}function Nn(e,t){return An(e,t,"monthsShort")}function zn(e,t,n){return Vn(e,t,n,"weekdays")}function qn(e,t,n){return Vn(e,t,n,"weekdaysShort")}function Zn(e,t,n){return Vn(e,t,n,"weekdaysMin")}function Kn(){var e=this._data;return this._milliseconds=Ki(this._milliseconds),this._days=Ki(this._days),this._months=Ki(this._months),e.milliseconds=Ki(e.milliseconds),e.seconds=Ki(e.seconds),e.minutes=Ki(e.minutes),e.hours=Ki(e.hours),e.months=Ki(e.months),e.years=Ki(e.years),this}function Bn(e,t,n,r){var i=Ft(t,n);return e._milliseconds+=r*i._milliseconds,e._days+=r*i._days,e._months+=r*i._months,e._bubble()}function Jn(e,t){return Bn(this,e,t,1)}function $n(e,t){return Bn(this,e,t,-1)}function Qn(e){return e<0?Math.floor(e):Math.ceil(e)}function Xn(){var e,t,n,r,i,s=this._milliseconds,o=this._days,a=this._months,u=this._data;return s>=0&&o>=0&&a>=0||s<=0&&o<=0&&a<=0||(s+=864e5*Qn(tr(a)+o),o=0,a=0),u.milliseconds=s%1e3,e=v(s/1e3),u.seconds=e%60,t=v(e/60),u.minutes=t%60,n=v(t/60),u.hours=n%24,o+=v(n/24),i=v(er(o)),a+=i,o-=Qn(tr(i)),r=v(a/12),a%=12,u.days=o,u.months=a,u.years=r,this}function er(e){return 4800*e/146097}function tr(e){return 146097*e/4800}function nr(e){var t,n,r=this._milliseconds;if(e=R(e),"month"===e||"year"===e)return t=this._days+r/864e5,n=this._months+er(t),"month"===e?n:n/12;switch(t=this._days+Math.round(tr(this._months)),e){case"week":return t/7+r/6048e5;case"day":return t+r/864e5;case"hour":return 24*t+r/36e5;case"minute":return 1440*t+r/6e4;case"second":return 86400*t+r/1e3;case"millisecond":return Math.floor(864e5*t)+r;default:throw new Error("Unknown unit "+e)}}function rr(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*k(this._months/12)}function ir(e){return function(){return this.as(e)}}function sr(e){return e=R(e),this[e+"s"]()}function or(e){return function(){return this._data[e]}}function ar(){return v(this.days()/7)}function ur(e,t,n,r,i){return i.relativeTime(t||1,!!n,e,r)}function cr(e,t,n){var r=Ft(e).abs(),i=ds(r.as("s")),s=ds(r.as("m")),o=ds(r.as("h")),a=ds(r.as("d")),u=ds(r.as("M")),c=ds(r.as("y")),d=i<ls.s&&["s",i]||s<=1&&["m"]||s<ls.m&&["mm",s]||o<=1&&["h"]||o<ls.h&&["hh",o]||a<=1&&["d"]||a<ls.d&&["dd",a]||u<=1&&["M"]||u<ls.M&&["MM",u]||c<=1&&["y"]||["yy",c];return d[2]=t,d[3]=+e>0,d[4]=n,ur.apply(null,d)}function dr(e){return void 0===e?ds:"function"==typeof e&&(ds=e,!0)}function lr(e,t){return void 0!==ls[e]&&(void 0===t?ls[e]:(ls[e]=t,!0))}function hr(e){var t=this.localeData(),n=cr(this,!e,t);return e&&(n=t.pastFuture(+this,n)),t.postformat(n)}function fr(){var e,t,n,r=hs(this._milliseconds)/1e3,i=hs(this._days),s=hs(this._months);e=v(r/60),t=v(e/60),r%=60,e%=60,n=v(s/12),s%=12;var o=n,a=s,u=i,c=t,d=e,l=r,h=this.asSeconds();return h?(h<0?"-":"")+"P"+(o?o+"Y":"")+(a?a+"M":"")+(u?u+"D":"")+(c||d||l?"T":"")+(c?c+"H":"")+(d?d+"M":"")+(l?l+"S":""):"P0D"}var pr,mr;mr=Array.prototype.some?Array.prototype.some:function(e){for(var t=this,n=Object(this),r=n.length>>>0,i=0;i<r;i++)if(i in n&&e.call(t,n[i],i,n))return!0;return!1};var yr=t.momentProperties=[],_r=!1,gr={};t.suppressDeprecationWarnings=!1,t.deprecationHandler=null;var vr;vr=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)u(e,t)&&n.push(t);return n};var kr,wr={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},br={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},Sr="Invalid date",xr="%d",Dr=/\d{1,2}/,Mr={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},Yr={},Or={},Tr=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Pr=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Ir={},Wr={},jr=/\d/,Cr=/\d\d/,Gr=/\d{3}/,Rr=/\d{4}/,Ur=/[+-]?\d{6}/,Er=/\d\d?/,Lr=/\d\d\d\d?/,Fr=/\d\d\d\d\d\d?/,Ar=/\d{1,3}/,Vr=/\d{1,4}/,Hr=/[+-]?\d{1,6}/,Nr=/\d+/,zr=/[+-]?\d+/,qr=/Z|[+-]\d\d:?\d\d/gi,Zr=/Z|[+-]\d\d(?::?\d\d)?/gi,Kr=/[+-]?\d+(\.\d{1,3})?/,Br=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Jr={},$r={},Qr=0,Xr=1,ei=2,ti=3,ni=4,ri=5,ii=6,si=7,oi=8;kr=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t,n=this;for(t=0;t<this.length;++t)if(n[t]===e)return t;return-1},q("M",["MM",2],"Mo",function(){return this.month()+1}),q("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),q("MMMM",0,0,function(e){return this.localeData().months(this,e)}),G("month","M"),E("month",8),$("M",Er),$("MM",Er,Cr),$("MMM",function(e,t){return t.monthsShortRegex(e)}),$("MMMM",function(e,t){return t.monthsRegex(e)}),te(["M","MM"],function(e,t){t[Xr]=k(e)-1}),te(["MMM","MMMM"],function(e,t,n,r){var i=n._locale.monthsParse(e,r,n._strict);null!=i?t[Xr]=i:h(n).invalidMonth=e});var ai=/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/,ui="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ci="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),di=Br,li=Br;q("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e}),q(0,["YY",2],0,function(){return this.year()%100}),q(0,["YYYY",4],0,"year"),q(0,["YYYYY",5],0,"year"),q(0,["YYYYYY",6,!0],0,"year"),G("year","y"),E("year",1),$("Y",zr),$("YY",Er,Cr),$("YYYY",Vr,Rr),$("YYYYY",Hr,Ur),$("YYYYYY",Hr,Ur),te(["YYYYY","YYYYYY"],Qr),te("YYYY",function(e,n){n[Qr]=2===e.length?t.parseTwoDigitYear(e):k(e)}),te("YY",function(e,n){n[Qr]=t.parseTwoDigitYear(e)}),te("Y",function(e,t){t[Qr]=parseInt(e,10)}),t.parseTwoDigitYear=function(e){return k(e)+(k(e)>68?1900:2e3)};var hi=F("FullYear",!0);q("w",["ww",2],"wo","week"),q("W",["WW",2],"Wo","isoWeek"),G("week","w"),G("isoWeek","W"),E("week",5),E("isoWeek",5),$("w",Er),$("ww",Er,Cr),$("W",Er),$("WW",Er,Cr),ne(["w","ww","W","WW"],function(e,t,n,r){t[r.substr(0,1)]=k(e)});var fi={dow:0,doy:6};q("d",0,"do","day"),q("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),q("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),q("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),q("e",0,0,"weekday"),q("E",0,0,"isoWeekday"),G("day","d"),G("weekday","e"),G("isoWeekday","E"),E("day",11),E("weekday",11),E("isoWeekday",11),$("d",Er),$("e",Er),$("E",Er),$("dd",function(e,t){return t.weekdaysMinRegex(e)}),$("ddd",function(e,t){return t.weekdaysShortRegex(e)}),$("dddd",function(e,t){return t.weekdaysRegex(e)}),ne(["dd","ddd","dddd"],function(e,t,n,r){var i=n._locale.weekdaysParse(e,r,n._strict);null!=i?t.d=i:h(n).invalidWeekday=e}),ne(["d","e","E"],function(e,t,n,r){t[r]=k(e)});var pi="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),mi="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),yi="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),_i=Br,gi=Br,vi=Br;q("H",["HH",2],0,"hour"),q("h",["hh",2],0,He),q("k",["kk",2],0,Ne),q("hmm",0,0,function(){return""+He.apply(this)+z(this.minutes(),2)}),q("hmmss",0,0,function(){return""+He.apply(this)+z(this.minutes(),2)+z(this.seconds(),2)}),q("Hmm",0,0,function(){return""+this.hours()+z(this.minutes(),2)}),q("Hmmss",0,0,function(){return""+this.hours()+z(this.minutes(),2)+z(this.seconds(),2)}),ze("a",!0),ze("A",!1),G("hour","h"),E("hour",13),$("a",qe),$("A",qe),$("H",Er),$("h",Er),$("HH",Er,Cr),$("hh",Er,Cr),$("hmm",Lr),$("hmmss",Fr),$("Hmm",Lr),$("Hmmss",Fr),te(["H","HH"],ti),te(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),te(["h","hh"],function(e,t,n){t[ti]=k(e),h(n).bigHour=!0}),te("hmm",function(e,t,n){var r=e.length-2;t[ti]=k(e.substr(0,r)),t[ni]=k(e.substr(r)),h(n).bigHour=!0;
}),te("hmmss",function(e,t,n){var r=e.length-4,i=e.length-2;t[ti]=k(e.substr(0,r)),t[ni]=k(e.substr(r,2)),t[ri]=k(e.substr(i)),h(n).bigHour=!0}),te("Hmm",function(e,t,n){var r=e.length-2;t[ti]=k(e.substr(0,r)),t[ni]=k(e.substr(r))}),te("Hmmss",function(e,t,n){var r=e.length-4,i=e.length-2;t[ti]=k(e.substr(0,r)),t[ni]=k(e.substr(r,2)),t[ri]=k(e.substr(i))});var ki,wi=/[ap]\.?m?\.?/i,bi=F("Hours",!0),Si={calendar:wr,longDateFormat:br,invalidDate:Sr,ordinal:xr,ordinalParse:Dr,relativeTime:Mr,months:ui,monthsShort:ci,week:fi,weekdays:pi,weekdaysMin:yi,weekdaysShort:mi,meridiemParse:wi},xi={},Di=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,Mi=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,Yi=/Z|[+-]\d\d(?::?\d\d)?/,Oi=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],Ti=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Pi=/^\/?Date\((\-?\d+)/i;t.createFromInputFallback=S("value provided is not in a recognized ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),t.ISO_8601=function(){};var Ii=S("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=gt.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:p()}),Wi=S("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=gt.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:p()}),ji=function(){return Date.now?Date.now():+new Date};Dt("Z",":"),Dt("ZZ",""),$("Z",Zr),$("ZZ",Zr),te(["Z","ZZ"],function(e,t,n){n._useUTC=!0,n._tzm=Mt(Zr,e)});var Ci=/([\+\-]|\d\d)/gi;t.updateOffset=function(){};var Gi=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,Ri=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;Ft.fn=bt.prototype;var Ui=Nt(1,"add"),Ei=Nt(-1,"subtract");t.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",t.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var Li=S("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});q(0,["gg",2],0,function(){return this.weekYear()%100}),q(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Dn("gggg","weekYear"),Dn("ggggg","weekYear"),Dn("GGGG","isoWeekYear"),Dn("GGGGG","isoWeekYear"),G("weekYear","gg"),G("isoWeekYear","GG"),E("weekYear",1),E("isoWeekYear",1),$("G",zr),$("g",zr),$("GG",Er,Cr),$("gg",Er,Cr),$("GGGG",Vr,Rr),$("gggg",Vr,Rr),$("GGGGG",Hr,Ur),$("ggggg",Hr,Ur),ne(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,r){t[r.substr(0,2)]=k(e)}),ne(["gg","GG"],function(e,n,r,i){n[i]=t.parseTwoDigitYear(e)}),q("Q",0,"Qo","quarter"),G("quarter","Q"),E("quarter",7),$("Q",jr),te("Q",function(e,t){t[Xr]=3*(k(e)-1)}),q("D",["DD",2],"Do","date"),G("date","D"),E("date",9),$("D",Er),$("DD",Er,Cr),$("Do",function(e,t){return e?t._ordinalParse:t._ordinalParseLenient}),te(["D","DD"],ei),te("Do",function(e,t){t[ei]=k(e.match(Er)[0],10)});var Fi=F("Date",!0);q("DDD",["DDDD",3],"DDDo","dayOfYear"),G("dayOfYear","DDD"),E("dayOfYear",4),$("DDD",Ar),$("DDDD",Gr),te(["DDD","DDDD"],function(e,t,n){n._dayOfYear=k(e)}),q("m",["mm",2],0,"minute"),G("minute","m"),E("minute",14),$("m",Er),$("mm",Er,Cr),te(["m","mm"],ni);var Ai=F("Minutes",!1);q("s",["ss",2],0,"second"),G("second","s"),E("second",15),$("s",Er),$("ss",Er,Cr),te(["s","ss"],ri);var Vi=F("Seconds",!1);q("S",0,0,function(){return~~(this.millisecond()/100)}),q(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),q(0,["SSS",3],0,"millisecond"),q(0,["SSSS",4],0,function(){return 10*this.millisecond()}),q(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),q(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),q(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),q(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),q(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),G("millisecond","ms"),E("millisecond",16),$("S",Ar,jr),$("SS",Ar,Cr),$("SSS",Ar,Gr);var Hi;for(Hi="SSSS";Hi.length<=9;Hi+="S")$(Hi,Nr);for(Hi="S";Hi.length<=9;Hi+="S")te(Hi,Cn);var Ni=F("Milliseconds",!1);q("z",0,0,"zoneAbbr"),q("zz",0,0,"zoneName");var zi=_.prototype;zi.add=Ui,zi.calendar=Zt,zi.clone=Kt,zi.diff=tn,zi.endOf=pn,zi.format=on,zi.from=an,zi.fromNow=un,zi.to=cn,zi.toNow=dn,zi.get=H,zi.invalidAt=Sn,zi.isAfter=Bt,zi.isBefore=Jt,zi.isBetween=$t,zi.isSame=Qt,zi.isSameOrAfter=Xt,zi.isSameOrBefore=en,zi.isValid=wn,zi.lang=Li,zi.locale=ln,zi.localeData=hn,zi.max=Wi,zi.min=Ii,zi.parsingFlags=bn,zi.set=N,zi.startOf=fn,zi.subtract=Ei,zi.toArray=gn,zi.toObject=vn,zi.toDate=_n,zi.toISOString=sn,zi.toJSON=kn,zi.toString=rn,zi.unix=yn,zi.valueOf=mn,zi.creationData=xn,zi.year=hi,zi.isLeapYear=_e,zi.weekYear=Mn,zi.isoWeekYear=Yn,zi.quarter=zi.quarters=Wn,zi.month=de,zi.daysInMonth=le,zi.week=zi.weeks=Ye,zi.isoWeek=zi.isoWeeks=Oe,zi.weeksInYear=Tn,zi.isoWeeksInYear=On,zi.date=Fi,zi.day=zi.days=Re,zi.weekday=Ue,zi.isoWeekday=Ee,zi.dayOfYear=jn,zi.hour=zi.hours=bi,zi.minute=zi.minutes=Ai,zi.second=zi.seconds=Vi,zi.millisecond=zi.milliseconds=Ni,zi.utcOffset=Tt,zi.utc=It,zi.local=Wt,zi.parseZone=jt,zi.hasAlignedHourOffset=Ct,zi.isDST=Gt,zi.isLocal=Ut,zi.isUtcOffset=Et,zi.isUtc=Lt,zi.isUTC=Lt,zi.zoneAbbr=Gn,zi.zoneName=Rn,zi.dates=S("dates accessor is deprecated. Use date instead.",Fi),zi.months=S("months accessor is deprecated. Use month instead",de),zi.years=S("years accessor is deprecated. Use year instead",hi),zi.zone=S("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Pt),zi.isDSTShifted=S("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Rt);var qi=zi,Zi=O.prototype;Zi.calendar=T,Zi.longDateFormat=P,Zi.invalidDate=I,Zi.ordinal=W,Zi.preparse=Ln,Zi.postformat=Ln,Zi.relativeTime=j,Zi.pastFuture=C,Zi.set=M,Zi.months=se,Zi.monthsShort=oe,Zi.monthsParse=ue,Zi.monthsRegex=fe,Zi.monthsShortRegex=he,Zi.week=xe,Zi.firstDayOfYear=Me,Zi.firstDayOfWeek=De,Zi.weekdays=Ie,Zi.weekdaysMin=je,Zi.weekdaysShort=We,Zi.weekdaysParse=Ge,Zi.weekdaysRegex=Le,Zi.weekdaysShortRegex=Fe,Zi.weekdaysMinRegex=Ae,Zi.isPM=Ze,Zi.meridiem=Ke,Qe("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,n=1===k(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+n}}),t.lang=S("moment.lang is deprecated. Use moment.locale instead.",Qe),t.langData=S("moment.langData is deprecated. Use moment.localeData instead.",tt);var Ki=Math.abs,Bi=ir("ms"),Ji=ir("s"),$i=ir("m"),Qi=ir("h"),Xi=ir("d"),es=ir("w"),ts=ir("M"),ns=ir("y"),rs=or("milliseconds"),is=or("seconds"),ss=or("minutes"),os=or("hours"),as=or("days"),us=or("months"),cs=or("years"),ds=Math.round,ls={s:45,m:45,h:22,d:26,M:11},hs=Math.abs,fs=bt.prototype;fs.abs=Kn,fs.add=Jn,fs.subtract=$n,fs.as=nr,fs.asMilliseconds=Bi,fs.asSeconds=Ji,fs.asMinutes=$i,fs.asHours=Qi,fs.asDays=Xi,fs.asWeeks=es,fs.asMonths=ts,fs.asYears=ns,fs.valueOf=rr,fs._bubble=Xn,fs.get=sr,fs.milliseconds=rs,fs.seconds=is,fs.minutes=ss,fs.hours=os,fs.days=as,fs.weeks=ar,fs.months=us,fs.years=cs,fs.humanize=hr,fs.toISOString=fr,fs.toString=fr,fs.toJSON=fr,fs.locale=ln,fs.localeData=hn,fs.toIsoString=S("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",fr),fs.lang=Li,q("X",0,0,"unix"),q("x",0,0,"valueOf"),$("x",zr),$("X",Kr),te("X",function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))}),te("x",function(e,t,n){n._d=new Date(k(e))}),t.version="2.15.1",n(gt),t.fn=qi,t.min=kt,t.max=wt,t.now=ji,t.utc=d,t.unix=Un,t.months=Hn,t.isDate=o,t.locale=Qe,t.invalid=p,t.duration=Ft,t.isMoment=g,t.weekdays=zn,t.parseZone=En,t.localeData=tt,t.isDuration=St,t.monthsShort=Nn,t.weekdaysMin=Zn,t.defineLocale=Xe,t.updateLocale=et,t.locales=nt,t.weekdaysShort=qn,t.normalizeUnits=R,t.relativeTimeRounding=dr,t.relativeTimeThreshold=lr,t.calendarFormat=qt,t.prototype=qi;var ps=t;return ps})}),K=Z&&"object"==typeof Z&&"default"in Z?Z.default:Z,B=function(e){function t(){e.call(this),this._sizeClass=null,this._detail=null,this.highlightIndexes={uber:1,hailo:3,addisonlee:5},this.onStorageUpdate=this.onStorageUpdate.bind(this)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.loadView=function(e){this._sizeClass=e.sizeClass.current,e.params&&e.params.detail&&(this._detail=e.params.detail),this.storage.subscribe(["year","month","day","config"],this.onStorageUpdate);var t=[];return t.push(this.storage.get({bucket:"_redsift",keys:["webhooks/settings-wh"]})),t.push(this.getData(this._detail)),t.push(this.getConfig()),{html:"view.html",data:Promise.all(t).then(function(e){return{webhooks:{settings:e[0][0].value},data:e[1],config:e[2]}})}},t.prototype.onStorageUpdate=function(e){var t=this,n=[];n.push(this.getData(this._detail)),n.push(this.getConfig()),Promise.all(n).then(function(e){t.publish("storageupdate",{data:e[0],config:e[1]})})},t.prototype.getData=function(e){var t=[];return t.push(this._getMonthData(e)),t.push(this._getYTDData()),t.push(this._getTodayData()),Promise.all(t).then(function(e){var t=e[0];return t.stats.ytd=e[1],t.stats.today=e[2],t})},t.prototype.getConfig=function(){return this.storage.getAll({bucket:"config"}).then(function(e){var t={};return e.forEach(function(e){t[e.key]=e.value}),t})},t.prototype._getTodayData=function(){return this.storage.get({bucket:"day",keys:[K().utc().startOf("day").valueOf().toString()]}).then(function(e){if(e[0].value)return JSON.parse(e[0].value).total})},t.prototype._getYTDData=function(){return this.storage.get({bucket:"year",keys:[""+K().year()]}).then(function(e){if(e[0].value)return JSON.parse(e[0].value).total})},t.prototype._getMonthData=function(e){var t=this,n=this._getChartKeys(this._sizeClass.width,e);return this.storage.get({bucket:"month",keys:n}).then(function(n){var r={trips:0,total:0,average:0},i=[0,0,0],s=n.map(function(n){var s=parseInt(n.key),o={l:s,v:[0,0,0,0,0,0]};if(n.value){var a=JSON.parse(n.value);a.companies.forEach(function(e,t){var n=0===t?0:2;o.v[n*t]+=e,i[t]+=e}),r.trips+=a.trips,r.total+=a.total,s===K().utc().startOf("month").valueOf()&&(r.mtd=a.total)}return e&&e.month===s&&(o.v[t.highlightIndexes[e.company]]=parseInt(e.total)),o});r.trips>0&&(r.average=r.total/r.trips);var o={lines:s,pie:i,stats:r};return e&&(o.hcompany=e.company),o})},t.prototype._getChartKeys=function(e,t){var n=6;e&&480!==e||(n=12);for(var r=[],i=0;i<n;i++)t?r.unshift(K.utc(parseInt(t.month)).subtract(i,"months").valueOf().toString()):r.unshift(K().utc().startOf("month").subtract(i,"months").valueOf().toString());return r},t}(q);return _(new B),B});