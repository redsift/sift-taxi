!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.SiftTaxi=t()}(this,function(){function e(e,t){return t={exports:{}},e(t,t.exports),t.exports}function t(e){console.log("[Redsift::registerEmailClientController]: registered")}var n=function(){this._proxy=self,this._registerMessageListeners()};n.prototype._registerMessageListeners=function(){var e=this;this._proxy&&(this._proxy.onmessage=function(t){var n=t.data.method;e["_"+n]&&e["_"+n](t.data.params)})},n.prototype._emailStats=function(e){this.onstats&&this.onstats(e.name,e.value)},n.prototype._getThreadRowDisplayInfo=function(e){var t=this,n={};e.tris.forEach(function(o){void 0!==o.value&&void 0!==o.value.list&&t.loadThreadListView&&(n[o.key]=t.loadThreadListView(o.value.list,e.supportedTemplates))}),this._proxy.postMessage({method:"getThreadRowDisplayInfoCallback",params:n})};var o="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},r=e(function(e){!function(t,n){"use strict";"function"==typeof define&&define.amd?define(n):"object"==typeof e&&e.exports?e.exports=n():t.log=n()}(o,function(){"use strict";function e(e){return typeof console!==u&&(void 0!==console[e]?t(console,e):void 0!==console.log?t(console,"log"):s)}function t(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function n(e,t,n){return function(){typeof console!==u&&(o.call(this,t,n),this[e].apply(this,arguments))}}function o(e,t){for(var n=this,o=0;o<a.length;o++){var r=a[o];n[r]=o<e?s:n.methodFactory(r,e,t)}}function r(t,o,r){return e(t)||n.apply(this,arguments)}function i(e,t,n){function i(e){var t=(a[e]||"silent").toUpperCase();try{return void(window.localStorage[f]=t)}catch(e){}try{window.document.cookie=encodeURIComponent(f)+"="+t+";"}catch(e){}}function s(){var e;try{e=window.localStorage[f]}catch(e){}if(typeof e===u)try{var t=window.document.cookie,n=t.indexOf(encodeURIComponent(f)+"=");n&&(e=/^([^;]+)/.exec(t.slice(n))[1])}catch(e){}return void 0===l.levels[e]&&(e=void 0),e}var c,l=this,f="loglevel";e&&(f+=":"+e),l.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},l.methodFactory=n||r,l.getLevel=function(){return c},l.setLevel=function(t,n){if("string"==typeof t&&void 0!==l.levels[t.toUpperCase()]&&(t=l.levels[t.toUpperCase()]),!("number"==typeof t&&t>=0&&t<=l.levels.SILENT))throw"log.setLevel() called with invalid level: "+t;if(c=t,n!==!1&&i(t),o.call(l,t,e),typeof console===u&&t<l.levels.SILENT)return"No console available for logging"},l.setDefaultLevel=function(e){s()||l.setLevel(e,!1)},l.enableAll=function(e){l.setLevel(l.levels.TRACE,e)},l.disableAll=function(e){l.setLevel(l.levels.SILENT,e)};var d=s();null==d&&(d=null==t?"WARN":t),l.setLevel(d,!1)}var s=function(){},u="undefined",a=["trace","debug","info","warn","error"],c=new i,l={};c.getLogger=function(e){if("string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=l[e];return t||(t=l[e]=new i(e,c.getLevel(),c.methodFactory)),t};var f=typeof window!==u?window.log:void 0;return c.noConflict=function(){return typeof window!==u&&window.log===c&&(window.log=f),c},c})}),i=r&&"object"==typeof r&&"default"in r?r.default:r,s=e(function(e){"use strict";var t=Object.prototype.toString;e.exports=function(e){var n;return"[object Object]"===t.call(e)&&(n=Object.getPrototypeOf(e),null===n||n===Object.getPrototypeOf({}))}}),u=s&&"object"==typeof s&&"default"in s?s.default:s,a=e(function(e,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=o.IDBKeyRange||o.webkitIDBKeyRange;if(e instanceof t)return e;if("undefined"==typeof e||null===e)return null;if(!(0,s.default)(e))return t.only(e);var n=Object.keys(e).sort();if(1===n.length){var r=n[0],i=e[r];switch(r){case"eq":return t.only(i);case"gt":return t.lowerBound(i,!0);case"lt":return t.upperBound(i,!0);case"gte":return t.lowerBound(i);case"lte":return t.upperBound(i);default:throw new TypeError('"'+r+'" is not valid key')}}else{var u=e[n[0]],a=e[n[1]],c=n.join("-");switch(c){case"gt-lt":return t.bound(u,a,!0,!0);case"gt-lte":return t.bound(u,a,!0,!1);case"gte-lt":return t.bound(u,a,!1,!0);case"gte-lte":return t.bound(u,a,!1,!1);default:throw new TypeError('"'+c+'" are conflicted keys')}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=u,s=n(i);e.exports=t.default}),c=a&&"object"==typeof a&&"default"in a?a.default:a,l=e(function(e){function t(e,t,n,o){this.store=e,this.name=t,this.field=n,this.opts=o,this.multi=o.multi||o.multiEntry||!1,this.unique=o.unique||!1}var n=c;e.exports=t,t.prototype.get=function(e,t){function n(e){o.push(e.value),e.continue()}var o=[],r=this.unique,i={range:e,iterator:n};this.cursor(i,function(e){return e?t(e):void(r?t(null,o[0]):t(null,o))})},t.prototype.count=function(e,t){var o=this.store.name,r=this.name;this.store.db.transaction("readonly",[o],function(i,s){if(i)return t(i);var u=s.objectStore(o).index(r),a=u.count(n(e));a.onerror=t,a.onsuccess=function(e){t(null,e.target.result)}})},t.prototype.cursor=function(e,t){e.index=this.name,this.store.cursor(e,t)}}),f=l&&"object"==typeof l&&"default"in l?l.default:l,d=e(function(e){var t=Object.prototype.toString;e.exports=function(e){switch(t.call(e)){case"[object Date]":return"date";case"[object RegExp]":return"regexp";case"[object Arguments]":return"arguments";case"[object Array]":return"array";case"[object Error]":return"error"}return null===e?"null":void 0===e?"undefined":e!==e?"nan":e&&1===e.nodeType?"element":(e=e.valueOf?e.valueOf():Object.prototype.valueOf.apply(e),typeof e)}}),p=d&&"object"==typeof d&&"default"in d?d.default:d,h=e(function(e){function t(e,t){this.db=null,this.name=e,this.indexes={},this.opts=t,this.key=t.key||t.keyPath||void 0,this.increment=t.increment||t.autoIncretement||void 0}var n=p,o=c;e.exports=t,t.prototype.index=function(e){return this.indexes[e]},t.prototype.put=function(e,t,o){var r=this.name,i=this.key;i&&("object"==n(e)?(o=t,t=e,e=null):t[i]=e),this.db.transaction("readwrite",[r],function(n,s){if(n)return o(n);var u=s.objectStore(r),a=i?u.put(t):u.put(t,e);s.onerror=s.onabort=a.onerror=o,s.oncomplete=function(){o(null,a.result)}})},t.prototype.get=function(e,t){var n=this.name;this.db.transaction("readonly",[n],function(o,r){if(o)return t(o);var i=r.objectStore(n),s=i.get(e);s.onerror=t,s.onsuccess=function(e){t(null,e.target.result)}})},t.prototype.del=function(e,t){var n=this.name;this.db.transaction("readwrite",[n],function(o,r){if(o)return t(o);var i=r.objectStore(n),s=i.delete(e);r.onerror=r.onabort=s.onerror=t,r.oncomplete=function(){t()}})},t.prototype.count=function(e){var t=this.name;this.db.transaction("readonly",[t],function(n,o){if(n)return e(n);var r=o.objectStore(t),i=r.count();i.onerror=e,i.onsuccess=function(t){e(null,t.target.result)}})},t.prototype.clear=function(e){var t=this.name;this.db.transaction("readwrite",[t],function(n,o){if(n)return e(n);var r=o.objectStore(t),i=r.clear();o.onerror=o.onabort=i.onerror=e,o.oncomplete=function(){e()}})},t.prototype.batch=function(e,t){var n=this.name,o=this.key,r=Object.keys(e);this.db.transaction("readwrite",[n],function(i,s){function u(){if(!(c>=r.length)){var n,i=r[c],s=e[i];null===s?n=a.delete(i):o?(s[o]||(s[o]=i),n=a.put(s)):n=a.put(s,i),n.onerror=t,n.onsuccess=u,c+=1}}if(i)return t(i);var a=s.objectStore(n),c=0;s.onerror=s.onabort=t,s.oncomplete=function(){t()},u()})},t.prototype.all=function(e){function t(e){n.push(e.value),e.continue()}var n=[];this.cursor({iterator:t},function(t){t?e(t):e(null,n)})},t.prototype.cursor=function(e,t){var n=this.name;this.db.transaction("readonly",[n],function(r,i){if(r)return t(r);var s=e.index?i.objectStore(n).index(e.index):i.objectStore(n),u=s.openCursor(o(e.range));u.onerror=t,u.onsuccess=function(n){var o=n.target.result;o?e.iterator(o):t()}})}}),y=h&&"object"==typeof h&&"default"in h?h.default:h,v=e(function(e){function t(){return this instanceof t?(this._stores={},this._current={},void(this._versions={})):new t}var n=p,o=y,r=f;e.exports=t,t.prototype.version=function(e){if("number"!=n(e)||e<1||e<this.getVersion())throw new TypeError("not valid version");return this._current={version:e,store:null},this._versions[e]={stores:[],dropStores:[],indexes:[],dropIndexes:[],version:e},this},t.prototype.addStore=function(e,t){if("string"!=n(e))throw new TypeError("`name` is required");if(this._stores[e])throw new TypeError("store is already defined");var r=new o(e,t||{});return this._stores[e]=r,this._versions[this.getVersion()].stores.push(r),this._current.store=r,this},t.prototype.dropStore=function(e){if("string"!=n(e))throw new TypeError("`name` is required");var t=this._stores[e];if(!t)throw new TypeError("store is not defined");return delete this._stores[e],this._versions[this.getVersion()].dropStores.push(t),this},t.prototype.addIndex=function(e,t,o){if("string"!=n(e))throw new TypeError("`name` is required");if("string"!=n(t)&&"array"!=n(t))throw new TypeError("`field` is required");var i=this._current.store;if(i.indexes[e])throw new TypeError("index is already defined");var s=new r(i,e,t,o||{});return i.indexes[e]=s,this._versions[this.getVersion()].indexes.push(s),this},t.prototype.dropIndex=function(e){if("string"!=n(e))throw new TypeError("`name` is required");var t=this._current.store.indexes[e];if(!t)throw new TypeError("index is not defined");return delete this._current.store.indexes[e],this._versions[this.getVersion()].dropIndexes.push(t),this},t.prototype.getStore=function(e){if("string"!=n(e))throw new TypeError("`name` is required");if(!this._stores[e])throw new TypeError("store is not defined");return this._current.store=this._stores[e],this},t.prototype.getVersion=function(){return this._current.version},t.prototype.callback=function(){var e=Object.keys(this._versions).map(function(e){return this._versions[e]},this).sort(function(e,t){return e.version-t.version});return function(t){var n=t.target.result,o=t.target.transaction;e.forEach(function(e){t.oldVersion>=e.version||(e.stores.forEach(function(e){var t={};"undefined"!=typeof e.key&&(t.keyPath=e.key),"undefined"!=typeof e.increment&&(t.autoIncrement=e.increment),n.createObjectStore(e.name,t)}),e.dropStores.forEach(function(e){n.deleteObjectStore(e.name)}),e.indexes.forEach(function(e){var t=o.objectStore(e.store.name);t.createIndex(e.name,e.field,{unique:e.unique,multiEntry:e.multi})}),e.dropIndexes.forEach(function(e){var t=o.objectStore(e.store.name);t.deleteIndex(e.name)}))})}}}),g=v&&"object"==typeof v&&"default"in v?v.default:v,b=(e(function(e,t){function n(e,t){if(!(this instanceof n))return new n(e,t);if("string"!=s(e))throw new TypeError("`name` required");if(!(t instanceof u))throw new TypeError("not valid schema");this.name=e,this.status="close",this.origin=null,this.stores=t._stores,this.version=t.getVersion(),this.onupgradeneeded=t.callback(),Object.keys(this.stores).forEach(function(e){this.stores[e].db=this},this)}function r(){return i().cmp.apply(i(),arguments)}function i(){return o._indexedDB||o.indexedDB||o.msIndexedDB||o.mozIndexedDB||o.webkitIndexedDB}var s=p,u=g,a=y,c=f;t=e.exports=n,t.schema=u,t.cmp=r,t.Treo=n,t.Schema=u,t.Store=a,t.Index=c,n.prototype.use=function(e){return e(this,t),this},n.prototype.drop=function(e){var t=this.name;this.close(function(n){if(n)return e(n);var o=i().deleteDatabase(t);o.onerror=e,o.onsuccess=function(){e()}})},n.prototype.close=function(e){return"close"==this.status?e():void this.getInstance(function(t,n){return t?e(t):(n.origin=null,n.status="close",n.close(),void e())})},n.prototype.store=function(e){return this.stores[e]},n.prototype.getInstance=function(e){if("open"==this.status)return e(null,this.origin);if("opening"==this.status)return this.queue.push(e);this.status="opening",this.queue=[e];var t=this,n=i().open(this.name,this.version);n.onupgradeneeded=this.onupgradeneeded,n.onerror=n.onblocked=function(e){t.status="error",t.queue.forEach(function(t){t(e)}),delete t.queue},n.onsuccess=function(e){t.origin=e.target.result,t.status="open",t.origin.onversionchange=function(){t.close(function(){})},t.queue.forEach(function(e){e(null,t.origin)}),delete t.queue}},n.prototype.transaction=function(e,t,n){this.getInstance(function(o,r){o?n(o):n(null,r.transaction(t,e))})}}),i.getLogger("RSStorage:operations"));b.setLevel("warn");var m=function(e){function t(){e.call(this),this._companyColors={hailo:{color:"#000000",backgroundColor:"#ffbb00"},uber:{color:"#000000",backgroundColor:"#1fbad6"},addisonlee:{color:"#ffffff",backgroundColor:"#000000"}}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.loadThreadListView=function(e){var t=parseInt(e.total).toLocaleString(navigator.language,{style:"currency",currency:e.currency,maximumFractionDigits:2});e.converted===!0&&(t="~"+t);var n={template:"001_list_common_txt",value:{color:this._companyColors[e.company].color,backgroundColor:this._companyColors[e.company].backgroundColor}};return n.value.subtitle=t,n},t}(n);return t(new m),m});